//=========================================================
// src/Interrupts.c: generated by Hardware Configurator
//
// This file will be regenerated when saving a document.
// leave the sections inside the "$[...]" comment tags alone
// or they will be overwritten!
//=========================================================

         
// USER INCLUDES			
#include <SI_C8051F850_Register_Enums.h>

//-----------------------------------------------------------------------------
// Pin Definitions
//-----------------------------------------------------------------------------
SI_SBIT(LED1, SFR_P1, 0);                 // DS5 P1.0 LED
SI_SBIT(LED2, SFR_P1, 1);                 // DS6 P1.1 LED
SI_SBIT(S1, SFR_P1, 7);
SI_SBIT(S2_PM, SFR_P1, 3);


//-----------------------------------------------------------------------------
// PMATCH_ISR
//-----------------------------------------------------------------------------
//
// PMATCH ISR Content goes here. Remember to clear flag bits:
//
// The Port Match interrupt occurs whenever (Pn & PnMASK) != (PnMAT & PnMASK).
// We must disable the interrupt and wait until the switches are released in
// main, or else the interrupt will trigger multiple times.  It is generally
// not good practice to sit in an ISR for int32_t periods of time.
//
//-----------------------------------------------------------------------------
SI_INTERRUPT(PMATCH_ISR, PMATCH_IRQn)
{
	   // If the Port Match event occured on S1, toggle LED1.
	   if(S1 == 0)
	   {
	      LED1 = !LED1;
	   }

	   // If the Port Match event occured on S2 (connected to P1.2), toggle LED2
	   if(S2_PM == 0)
	   {
	      LED2 = !LED2;
	   }

	   EIE1 &= ~0x02;                      // Disable Port Match interrupts to
	                                       // prevent multiple interrupts from
	                                       // occurring while the switches are
	                                       // pressed
}


